<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.9">
<title>Quick start guide</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: DarkBlue;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Quick start guide</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="pet-hotel-sample-application">Pet Hotel sample application</h2>
<div class="sectionbody">
<div class="paragraph"><p>In this tutorial you&#8217;ll learn how to create a simple business
application in JavaScript using Platypus.js. The sample source code is
available for download from the Platypus.js project&#8217;s <a href="https://github.com/altsoft/pethotel">repository</a> on github.</p></div>
<div class="paragraph"><p>Please refer to the Development Guide and the Administration Guide for
more details about Platypus.js.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="platypus.js-installation">Platypus.js installation</h2>
<div class="sectionbody">
<div class="paragraph"><p>Java Runtime and JDK 8 update 40 or higher are required for Platypus.js applications
development.</p></div>
<div class="paragraph"><p>Install the Platypus.js IDE, the Platypus.js runtime components and
Apache Tomcat 8 to enable running a web client:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://platypus-platform.org/download.html">Download</a> the Platypus.js installer bundle from the project&#8217;s website
for your operating system.
</p>
</li>
<li>
<p>
Run the installer.
</p>
</li>
<li>
<p>
Follow the wizard&#8217;s steps and install the required components.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="the-sample-application-requirements">The sample application requirements</h2>
<div class="sectionbody">
<div class="paragraph"><p>The Pet Hotel is a simple business application for cats and dogs hotel accounting.</p></div>
<div class="paragraph"><p>The hotel&#8217;s administrator role is the only user role defined for this
application.</p></div>
<div class="paragraph"><p>An administrator can perform the following actions:</p></div>
<div class="ulist"><ul>
<li>
<p>
Search for the pet owners by her/his name and display the owners list.
</p>
</li>
<li>
<p>
Add, delete and update owner&#8217;s data.
</p>
</li>
<li>
<p>
Display an owner&#8217;s pets as a list.
</p>
</li>
<li>
<p>
Add, delete and update an owner&#8217;s pets records.
</p>
</li>
<li>
<p>
Add, delete and update the hotel attendance data for a pet.
</p>
</li>
<li>
<p>
Display and print the owners report.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The entered data must be validated according to the following rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
All owner&#8217;s and pet&#8217;s data fields are mandatory.
</p>
</li>
<li>
<p>
The check-in date must precede the check-out date.
Database structure is shown on following diagram (Fig.<a href="#appDomain">model diagram</a>).
</p>
</li>
</ul></div>
<div class="imageblock" id="appDomain">
<div class="content">
<img src="images/appDomain.png" alt="Pet Hotel knowledge domain model diagram">
</div>
<div class="title">Figure 1. Pet Hotel knowledge domain model diagram</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-sample-project-creation-and-setup">The sample project creation and setup</h2>
<div class="sectionbody">
<div class="paragraph"><p>During the installation process the Platypus.js IDE is configured for
the correct path to the runtime directory, Tomcat and a default database
connection. Check the platform&#8217;s runtime directory on Tools Platypus
Platform menu item in the global menu.</p></div>
<div class="paragraph"><p>After first launch of Platypus designer you will get window as it shown on Fig. <a href="#start_screen">start screen</a>.</p></div>
<div class="imageblock" id="start_screen">
<div class="content">
<img src="images/firstScreen.png" alt="First screen">
</div>
<div class="title">Figure 2. Platypus designer interface</div>
</div>
<div class="paragraph"><p>To create Platypus project you should select menu item <em>File &#8594; New Project</em> (Fig. <a href="#project_creation">project creation</a>).</p></div>
<div class="imageblock" id="project_creation">
<div class="content">
<img src="images/projectCreation.png" alt="Project creation">
</div>
<div class="title">Figure 3. Project creation</div>
</div>
<div class="paragraph"><p>Next, you should set project&#8217;s name and it&#8217;s location (Fig. <a href="#project_name">project name</a>).</p></div>
<div class="imageblock" id="project_name">
<div class="content">
<img src="images/projectName.png" alt="Choose project name">
</div>
<div class="title">Figure 4. Choose project name</div>
</div>
<div class="paragraph"><p>After project was created, we will set it&#8217;s properties so he could be started as HTML5 application. Perform right mouse button click and in menu choose <em>Properties</em>.
In modal window,shown on Fig. <a href="#project_properties">project properties</a>. Select <em>Client &#8594; HTML5 web browser</em> and <em>Application server &#8594; J2EE Server</em>.</p></div>
<div class="imageblock" id="project_properties">
<div class="content">
<img src="images/eeServer.png" alt="Select project properties">
</div>
<div class="title">Figure 5. Setting project properties</div>
</div>
<div class="paragraph"><p>In most cases Apache Tomcat application server is already installed and configured to work with Platypus, so you can skip following steps and check J2EE Server settings tab
(Fig. <a href="#project_server">project server</a>). In other cases you should add J2EE server manually. To do this, you should go to Services tab and perform right click on <em>Servers</em> item.
In context menu choose <em>Add Server</em>, on screen you will see following window (Fig. <a href="#selecting_server">add server</a>).</p></div>
<div class="imageblock" id="selecting_server">
<div class="content">
<img src="images/serverType.png" alt="Server type">
</div>
<div class="title">Figure 6. Selecting Java EE server type</div>
</div>
<div class="paragraph"><p>After you have selected server, click the <em>Next</em> button. We will show how to set <em>Apache Tomcat</em> server.  Using next menu (Fig. <a href="#tomcat">adding Tomcat</a>), browse server folder location and set
Username and password for user manager role.</p></div>
<div class="imageblock" id="tomcat">
<div class="content">
<img src="images/apacheCreation.png" alt="Tomcat folder selection">
</div>
<div class="title">Figure 7. Adding Apache Tomcat server folder</div>
</div>
<div class="paragraph"><p>Fine adjustment of Tomcat such as server port, could be performed on Fig. <a href="#tomcat_properties">tomcat properties</a>.</p></div>
<div class="imageblock" id="tomcat_properties">
<div class="content">
<img src="images/tomcatProperties.png" alt="Created server properties">
</div>
<div class="title">Figure 8. Tomcat properties</div>
</div>
<div class="paragraph"><p>Finally you should set J2EE Server settings for project properties (Fig. <a href="#project_server">project server</a>).</p></div>
<div class="imageblock" id="project_server">
<div class="content">
<img src="images/serverCreation.png" alt="Choose server type">
</div>
<div class="title">Figure 9. Choosing project&#8217;s Java EE server</div>
</div>
<div class="paragraph"><p>Create a new database connection for the Pet Hotel application. You can
use any of the databases supported by the platform. The easiest way is
to use H2 database, which is supplied with the platform and does not
require any additional configuration or administration.</p></div>
<div class="paragraph"><p>Use the instructions below to create the H2 datasource connection:</p></div>
<div class="paragraph"><p>Go to the Services panel.
Select the <em>New Connection&#8230;</em> menu item from the Databases node context
menu.</p></div>
<div class="imageblock" id="db_Type_Creation">
<div class="content">
<img src="images/db/dbTypeCreation.png" alt="db Type creation">
</div>
<div class="title">Figure 10. Database type</div>
</div>
<div class="paragraph"><p>Select the H2 JDBC driver, provide a user name, a password and a JDBC
URL in the following format:</p></div>
<div class="imageblock" id="connection_properties">
<div class="content">
<img src="images/db/h2ConnectionProperties.png" alt="connection properties">
</div>
<div class="title">Figure 11. Connection properties</div>
</div>
<div class="paragraph"><p>Select <span class="monospaced">PUBLIC</span> as the connection&#8217;s default schema.</p></div>
<div class="imageblock" id="schema_type">
<div class="content">
<img src="images/db/schemaType.png" alt="Schema type">
</div>
<div class="title">Figure 12. Schema type</div>
</div>
<div class="paragraph"><p>Click Next button. H2 database will be started and <span class="monospaced">pet_hotel</span>
database will be created in the user&#8217;s directory if it is not exist yet.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/caution.png" alt="Caution">
</td>
<td class="content">Connection name should be named by the JavaScript variables rules.</td>
</tr></table>
</div>
<div class="paragraph"><p>Set <span class="monospaced">pet_hotel</span> as a connection name.</p></div>
<div class="imageblock" id="connection_name">
<div class="content">
<img src="images/db/connectionName.png" alt="Connection name">
</div>
<div class="title">Figure 13. Connection name</div>
</div>
<div class="paragraph"><p>Create a new project for Pet Hotel application and provide the project&#8217;s
name and home directory. In the project&#8217;s properties select the
<span class="monospaced">pet_hotel</span> from the list as a default Datasource.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="defining-the-database-structure">Defining the database structure</h2>
<div class="sectionbody">
<div class="paragraph"><p>One way to begin building your application is to start from creating its
database structure. When using Platypus.js, you need to create a
database structure diagram.</p></div>
<div class="paragraph"><p>Add a new Database structure diagram application element. <em>File &#8594; New File &#8594; Database structure diagram</em>.</p></div>
<div class="paragraph"><p>On the diagram create new database tables named <span class="monospaced">Owner</span>, <span class="monospaced">Pet</span>,
<span class="monospaced">PetType</span> and <span class="monospaced">Visit</span> according to the knowledge domain model. A numeric
primary key is automatically created for each new table. Add all the
required fields for the tables.</p></div>
<div class="paragraph"><p>Create the foreign key links by connecting foreign key fields with the
correspondent primary keys files. Please note that the connected fields
must have the same data type.</p></div>
<div class="imageblock" id="database_structure">
<div class="content">
<img src="images/db/dbStructure.png" alt="Pet Hotel knowledge domain model diagram">
</div>
<div class="title">Figure 14. Database structure</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="owners-list-form">Owners list form</h2>
<div class="sectionbody">
<div class="paragraph"><p>We are going to build the user interface allowing to display the owners list.</p></div>
<div class="paragraph"><p>Create a new Form application element named <span class="monospaced">OwnersView</span>, check that the
JavaScript constructor for this form is also set to <span class="monospaced">OwnersView</span>. This
form will display the owners list.</p></div>
<div class="paragraph"><p>Also create a new Form application element named <span class="monospaced">OwnerView</span> , check
that the constructor is also set to <span class="monospaced">OwnerView</span>. The owners details will
be shown on this form. Save this form but for this moment leave it
blank.</p></div>
<div class="paragraph"><p>Now lets edit the <span class="monospaced">OwnersView</span> form.
<span class="monospaced">OwnersView</span> form will contain (Fig. <a href="#ownersView">owners view</a>):</p></div>
<div class="ulist"><ul>
<li>
<p>
On the top of the form: the panel with the Add and Delete buttons as
well as the search text field and the Search button.
</p>
</li>
<li>
<p>
The <span class="monospaced">ModelGrid</span> widget to display the owners list.
</p>
</li>
</ul></div>
<div class="imageblock" id="OwneresView">
<div class="content">
<img src="images/ui/ownersView.png" alt="Owners view">
</div>
<div class="title">Figure 15. Owners view</div>
</div>
<div class="paragraph"><p>Using <em>Palette</em> tool add elements to panel by drag-drop. Add the header panel from the containers palette on the form, put the
buttons and the text field from the standard components palette on the
panel. Provide meaningful names for the added components. Set texts to
the added buttons. Drag-and-drop a <span class="monospaced">ModelGrid</span> from the model widgets
palette on the form below the header panel and also provide a name for
it.</p></div>
<div class="paragraph"><p>Next lets configure the data model for our <span class="monospaced">OwnersView</span> form. Data model
allows persistent data to be read and written from/to the database. In
Platypus.js data model entities are created on the basis of data sources.
To access relational data create data sources from SQL queries.</p></div>
<div class="paragraph"><p>Create a new Query application element named <span class="monospaced">OwnersQuery</span> with SQL to
get filtered records from the <span class="monospaced">Owner</span> table:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@name</span><span style="font-style: italic"><span style="color: #9A1900"> OwnersQuery</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@public</span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">Select</span></span> t1<span style="color: #990000">.</span>OWNERS_ID<span style="color: #990000">,</span> <span style="color: #990000">(</span>t1<span style="color: #990000">.</span>FIRSTNAME <span style="color: #990000">||</span> <span style="color: #FF0000">' '</span> <span style="color: #990000">||</span> t1<span style="color: #990000">.</span>LASTNAME<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">AS</span></span> fullName<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>ADDRESS <span style="font-weight: bold"><span style="color: #0000FF">AS</span></span> address
<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>CITY <span style="font-weight: bold"><span style="color: #0000FF">AS</span></span> city<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>TELEPHONE <span style="font-weight: bold"><span style="color: #0000FF">AS</span></span> phone<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>email <span style="font-weight: bold"><span style="color: #0000FF">AS</span></span> email
<span style="font-weight: bold"><span style="color: #0000FF">From</span></span> OWNERS t1
 <span style="font-weight: bold"><span style="color: #0000FF">Where</span></span> t1<span style="color: #990000">.</span>LASTNAME <span style="font-weight: bold"><span style="color: #0000FF">Like</span></span> <span style="color: #990000">:</span>lastNamePattern</tt></pre></div></div>
<div class="paragraph"><p>In this SQL query we are concatenating the <span class="monospaced">firstname</span> and <span class="monospaced">lastname</span>
fields to return an owner&#8217;s full name. Use the <span class="monospaced">:lastNamePattern</span> to
provide a search pattern for the owner&#8217;s last name. Adding alias to the fields
allows us to use ORM (Object Relation Mapper) on any database in future.</p></div>
<div class="paragraph"><p>Add <span class="monospaced">@public</span> annotation to the query&#8217;s header to enable access via
network from a remote data model running on a client and save the query.</p></div>
<div class="paragraph"><p>Drag-and-drop it to the <span class="monospaced">OwnersView</span> data model. You may also go to the new entity&#8217;s
properties and provide its name, for example <span class="monospaced">owners</span>.</p></div>
<div class="imageblock" id="connection_name">
<div class="content">
<img src="images/query/ownersQuery.png" alt="OwnersView form data model">
</div>
<div class="title">Figure 16. Connection name</div>
</div>
<div class="paragraph"><p>Next, bind the <span class="monospaced">ModelGrid</span> widget to the <span class="monospaced">owners</span> entity as it shown in figure <a href="#bindGrid">grid binding</a>. Select the
Model binding data parameter and select the model entity to bind. Create the
grid&#8217;s columns using <em>Fill columns</em> context menu item. After that provide
the meaningful columns names and correct the columns captions (Fig. <a href="#inspector">Columns settings</a>).</p></div>
<div class="imageblock" id="bindGrid">
<div class="content">
<img src="images/settings/bindModel.png" alt="Binding data model to grid">
</div>
<div class="title">Figure 17. Binding data model to grid</div>
</div>
<div class="imageblock" id="inspector">
<div class="content">
<img src="images/settings/inspector.png" alt="Setting grid columns">
</div>
<div class="title">Figure 18. Setting grid columns</div>
</div>
<div class="paragraph"><p><span class="monospaced">ModelGrid</span> widget enables rows insertions and deletions as well as
editing of its its cells. The changes will be made in the bounded data
model entity. This way we can create a simple CRUD functionality even
without any coding. For our grid we disable this feature, because we are
going to use a separate form to edit a single owner&#8217;s record â€” disable
deletable, insertable and editable properties of the grid in it&#8217;s properties menu.</p></div>
<div class="paragraph"><p>Lets write some JavaScript code for our form.</p></div>
<div class="paragraph"><p>By default after creation form&#8217;s code looks like this:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">OwnersView</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> self <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span>
            <span style="color: #990000">,</span> model <span style="color: #990000">=</span> P<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">loadModel</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>constructor<span style="color: #990000">.</span>name<span style="color: #990000">)</span>
            <span style="color: #990000">,</span> form <span style="color: #990000">=</span> P<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">loadForm</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>constructor<span style="color: #990000">.</span>name<span style="color: #990000">,</span> model<span style="color: #990000">);</span>

    self<span style="color: #990000">.</span>show <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
        form<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">show</span></span><span style="color: #990000">();</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">;</span>

    <span style="font-style: italic"><span style="color: #9A1900">// TODO : place your code here</span></span>

    model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
        <span style="font-style: italic"><span style="color: #9A1900">// TODO : place your code here</span></span>
    <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Double click on the Add button and enter the code responsible for
showing the <span class="monospaced">OwnerView</span> form:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Add button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> event Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnAdd<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> ownerView <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OwnerView</span></span><span style="color: #990000">();</span>
   ownerView<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">showModal</span></span><span style="color: #990000">(</span>refresh<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>In this event handler we create a new instance of the owner&#8217;s details
form and show it as a modal window. We will create showModal method in detailed OvnerView later. We provide the <span class="monospaced">refresh</span> function as
a parameter to enable data model requery when closing the owner&#8217;s
details form:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">refresh</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">();</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Double click on the Delete button and provide the code fragment
responsible for an owner&#8217;s record deletion:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Delete button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> event Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnDelete<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">confirm</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Delete owner?"</span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> form<span style="color: #990000">.</span>modelGrid<span style="color: #990000">.</span>selected<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
                model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">splice</span></span><span style="color: #990000">(</span>model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">indexOf</span></span><span style="color: #990000">(</span>form<span style="color: #990000">.</span>modelGrid<span style="color: #990000">.</span>selected<span style="color: #990000">[</span>i<span style="color: #990000">]),</span> <span style="color: #993399">1</span><span style="color: #990000">);</span>
            <span style="color: #FF0000">}</span>
       model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">save</span></span><span style="color: #990000">();</span>
   <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>On Delete button click we are showing a confirmation dialogue and if the
action is confirmed the current row in the owners query will be deleted.
Then all changes will be saved to the database.
Data model is JavaScript array, so we use method <em>splice</em> to delete selected rows. Information about selected rows we get from modeGrid.</p></div>
<div class="paragraph"><p>Provide a handler for the <span class="monospaced">onMouseClicked</span> event of the grid widget:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Grid click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> event Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>modelGrid<span style="color: #990000">.</span>onMouseClicked <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">.</span>clickCount <span style="color: #990000">&gt;</span> <span style="color: #993399">1</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> ownerView <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OwnerView</span></span><span style="color: #990000">();</span>
            ownerView<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">showModal</span></span><span style="color: #990000">(</span>refresh<span style="color: #990000">,</span> model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span>cursor<span style="color: #990000">.</span>OWNERS_ID<span style="color: #990000">);</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>The code is seems familiar except the handling of the <span class="monospaced">ownerID</span>
parameter containing the grid&#8217;s current owner&#8217;s record identifier.</p></div>
<div class="paragraph"><p>Double click on the Search button to provide the search by a last name
action logic:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Search button click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> event Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnSearch<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> searchText <span style="color: #990000">=</span> <span style="color: #FF0000">"%"</span> <span style="color: #990000">+</span> form<span style="color: #990000">.</span>txtSearch<span style="color: #990000">.</span>text <span style="color: #990000">+</span> <span style="color: #FF0000">"%"</span><span style="color: #990000">;</span>
    model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span>params<span style="color: #990000">.</span>lastNamePattern <span style="color: #990000">=</span> searchText<span style="color: #990000">;</span>
    model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">();</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>When a new value is assigned to a model&#8217;s parameter the model&#8217;s data
linked to this parameter is automatically required according to the new
value.</p></div>
<div class="paragraph"><p>At this point we are ready to run and debug our application. Some test
data can be added to the database tables using our SQL query. When a
query is run the result are shown in a separate results window. You can
also insert, delete and update database records using this window.</p></div>
<div class="paragraph"><p>To obtain all data on form load we will add following code to method <em>show</em>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>self<span style="color: #990000">.</span>show <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
       form<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">show</span></span><span style="color: #990000">();</span>
       <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> searchText <span style="color: #990000">=</span> <span style="color: #FF0000">"%%"</span><span style="color: #990000">;</span>
       model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span>params<span style="color: #990000">.</span>lastNamePattern <span style="color: #990000">=</span> searchText<span style="color: #990000">;</span>
       model<span style="color: #990000">.</span>owners<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">();</span>
   <span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="owners-details-pets-and-visits-form">Owners details, pets and visits form</h2>
<div class="sectionbody">
<div class="paragraph"><p>Open the OwnerDetails form we&#8217;ve created earlier. This form will contain
the user interface related to a concrete owner, her/his pets and hotel
visits.</p></div>
<div class="imageblock" id="ownerDetail">
<div class="content">
<img src="images/ui/Ð¾wnerDetail.png" alt="OwnerDetails form layout">
</div>
<div class="title">Figure 19. Owner detail</div>
</div>
<div class="paragraph"><p>Add the Name, Last Name, Address, City, Phone and Email model <span class="monospaced">TextField</span>
widgets for an owner&#8217;s fields. Align this components to the right. Add
<span class="monospaced">Label</span> components to the left of the correspondent input text field.
Provide meaningful names for all components and set the labels texts.</p></div>
<div class="paragraph"><p>Drag-and-drop a <span class="monospaced">SplitPane</span> container from the containers palette and
set its separator orientation to vertical.</p></div>
<div class="paragraph"><p>Add a panel container on the left and right sides of the <span class="monospaced">SplitPane</span>.
The left panel is for an owner&#8217;s pets and the right side is for the
pet&#8217;s visit to the hotel.</p></div>
<div class="paragraph"><p>Place the Add and Delete buttons on top of the pets and the visits
panels.</p></div>
<div class="paragraph"><p>Add <span class="monospaced">ModelGrid</span> widgets on the left and the right panels to display pets
and the concrete pet&#8217;s visits list.</p></div>
<div class="paragraph"><p>At the bottom of the form add Ok and Cancel buttons to save an owner&#8217;s
data, as well as the pets and the pet&#8217;s visits data.</p></div>
<div class="paragraph"><p>At this moment we have our owner&#8217;s details form mock layout. Next we will
configure the form&#8217;s data model based on the SQL queries and write some
JavaScript code.</p></div>
<div class="paragraph"><p>Add a new application element for a SQL query selecting data for the
specific owner by her/his identifier:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Gets the owner by its ID.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@public</span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@name</span><span style="font-style: italic"><span style="color: #9A1900"> OwnerQuery</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">Select</span></span> <span style="color: #990000">*</span>
<span style="font-weight: bold"><span style="color: #0000FF">From</span></span> Owners t1
 <span style="font-weight: bold"><span style="color: #0000FF">Where</span></span> <span style="color: #990000">:</span>ownerID <span style="color: #990000">=</span> t1<span style="color: #990000">.</span>owner_id</tt></pre></div></div>
<div class="paragraph"><p>Add a query for the pets list for the specific owner:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Gets the pets for concrete owner.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@public</span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@name</span><span style="font-style: italic"><span style="color: #9A1900"> PetsQuery</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">Select</span></span> <span style="color: #990000">*</span>
<span style="font-weight: bold"><span style="color: #0000FF">From</span></span> Pets t1
 <span style="font-weight: bold"><span style="color: #0000FF">Where</span></span> <span style="color: #990000">:</span>ownerID <span style="color: #990000">=</span> t1<span style="color: #990000">.</span>owner</tt></pre></div></div>
<div class="paragraph"><p>Next, add a query for getting all the hotel visits for the all pets of
the specific owner:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Gets all visits for concrete owner.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@public</span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@name</span><span style="font-style: italic"><span style="color: #9A1900"> VisitsQuery</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">Select</span></span> t1<span style="color: #990000">.</span>visit_id<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>pet<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>fromdate<span style="color: #990000">,</span>
 t1<span style="color: #990000">.</span>todate<span style="color: #990000">,</span> t1<span style="color: #990000">.</span>description
<span style="font-weight: bold"><span style="color: #0000FF">From</span></span> Visit t1
 <span style="font-weight: bold"><span style="color: #0000FF">Inner</span></span> <span style="font-weight: bold"><span style="color: #0000FF">Join</span></span> PetsQuery t2 <span style="font-weight: bold"><span style="color: #0000FF">on</span></span> t1<span style="color: #990000">.</span>pet <span style="color: #990000">=</span> t2<span style="color: #990000">.</span>pet_id</tt></pre></div></div>
<div class="paragraph"><p>Add a simple query for selecting all pets types:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Gets all types for pets.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@public</span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@name</span><span style="font-style: italic"><span style="color: #9A1900"> PetTypesQuery</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">Select</span></span> <span style="color: #990000">*</span> <span style="font-weight: bold"><span style="color: #0000FF">From</span></span> PetType</tt></pre></div></div>
<div class="paragraph"><p>In data model of <em>ownerView</em> form, add this four queries so that our model will looks like shown in fig. <a href="#ownerView_model">owner view data model</a></p></div>
<div class="imageblock" id="ownerView_model">
<div class="content">
<img src="images/db/ovModel.png" alt="Owner model">
</div>
<div class="title">Figure 20. Created datamodel</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Scalar_and_collection_properties">Scalar and collection properties</h2>
<div class="sectionbody">
<div class="paragraph"><p>We need to create some scalar and collection properties for our <em>OwnerView</em> datamodel. You should select link between <em>petsQuery</em> and <em>petTypesQuery</em> and perform right mouse button click. In properties window (Fig. <a href="#petsCollection">pets Collection</a> set name for Scalar property name and Collection property name. Perform same task on connection between <em>petsQuery</em> and <em>visitsQuery</em> (Fig. <a href="#visitsCollection">visits collection</a>).</p></div>
<div class="imageblock" id="petsCollection">
<div class="content">
<img src="images/db/petsCollection.png" alt="Pets collection">
</div>
<div class="title">Figure 21. Pets collection</div>
</div>
<div class="imageblock" id="visitsCollection">
<div class="content">
<img src="images/db/visitsCollection.png" alt="Visits collection">
</div>
<div class="title">Figure 22. Visits collection</div>
</div>
<div class="paragraph"><p>As the form&#8217;s data model configuration is completed, bind the form&#8217;s model widget to the model.
Set the Model binding field property for the ModelText widgets on the
form and bind them to the name, last name, city and telephone fields of
the <span class="monospaced">ownerQuery</span> entity and set field&#8217;s property as corresponding data field;</p></div>
<div class="imageblock" id="fieldBinding">
<div class="content">
<img src="images/db/fieldBinding.png" alt="field binding">
</div>
<div class="title">Figure 23. Field binding</div>
</div>
<div class="paragraph"><p>The <span class="monospaced">visits</span> entity will hold all the visits for the all pets of the
concrete owner, but we want to show on the right grid only the visits
for the currently selected pet. To solve this issue we will use our collections, and create master-detail view.</p></div>
<div class="paragraph"><p>In Pet&#8217;s grid bind data to corresponding query (<em>petsQuery</em>) and use <em>Fill columns</em> context menu to create columns.
Using inspector (as it was shown earlier in Fig. <a href="#inspector">Inspector</a>) delete unnecessary columns with id&#8217;s and delete service column. Provide the correct text for the columns headers. Add Check grid column, so the user could select multiple pets.
Unlike the owners list grid the pets and visits grids will allow edit their cell data.</p></div>
<div class="paragraph"><p>Provide the ModelCombo widget as a cell component for the <em>petType</em> column on the pets grid (Fig. <a href="#combo_view">Combo View</a>). Set scalar property name, that we have defined earlier (<a href="#petsCollection">pets collection</a>) <em>type</em> to this column. For <em>ModelCombo</em> set <em>displayField</em> property to <em>name</em> and <em>displayList</em> to <em>petTypesQuery</em> (Fig. <a href="#combo_view_properties">combo properties</a>).</p></div>
<div class="imageblock" id="combo_view">
<div class="content">
<img src="images/settings/comboView.png" alt="combo view">
</div>
<div class="title">Figure 24. Combo view</div>
</div>
<div class="imageblock" id="combo_view_properties">
<div class="content">
<img src="images/settings/modelViewProperties.png" alt="combo view properties">
</div>
<div class="title">Figure 25. Combo view properties</div>
</div>
<div class="paragraph"><p>Master-detail view is creating by using two model grids, on same form. Master - is our pets, detail - pet&#8217;s visit. We should set grid properties for visits. Set data field - <em>petsQuery</em>, but field must be set as <em>cursor.visits</em>. This collection we have also defined earlier (<a href="#visitsCollection">visits collection</a>) ORM of <em>Platypus.JS</em> will automatically return certain collection for certain pet (Fig. <a href="#visitGridProperties">visit grid properties</a> ).</p></div>
<div class="imageblock" id="visitGridProperties">
<div class="content">
<img src="images/settings/visitGridProperties.png" alt="combo view properties">
</div>
<div class="title">Figure 26. Visit grid properties</div>
</div>
<div class="paragraph"><p>Add model grid columns and set they field&#8217;s as corresponding names of <em>visitsQuery</em> fields. Set presentation type in inspector as it shown in Fig. <a href="#visitGrid">visit grid column properties</a>.</p></div>
<div class="imageblock" id="visitGrid">
<div class="content">
<img src="images/settings/visitGrid.png" alt="combo view properties">
</div>
<div class="title">Figure 27. Visit grid columns view</div>
</div>
<div class="paragraph"><p>At the next step we&#8217;ll write some JavaScript code for the OwnerView
form.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>self<span style="color: #990000">.</span>showModal <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>aCallback<span style="color: #990000">,</span> aID<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    callback <span style="color: #990000">=</span> aCallback<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>aID<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        model<span style="color: #990000">.</span>ownerQuery<span style="color: #990000">.</span>params<span style="color: #990000">.</span>ownerID <span style="color: #990000">=</span> aID<span style="color: #990000">;</span>
        model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">();</span>
    <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
        model<span style="color: #990000">.</span>ownerQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{}</span><span style="color: #990000">);</span>
    <span style="color: #FF0000">}</span>
    form<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">showModal</span></span><span style="color: #990000">();</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Double click on the OK button and insert the handler code to save the
owner&#8217;s data:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>form<span style="color: #990000">.</span>btnSave<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>model<span style="color: #990000">.</span>modified<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> message <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">validate</span></span><span style="color: #990000">();</span>
            <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>message<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
                model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">save</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
                    <span style="font-weight: bold"><span style="color: #000000">callback</span></span><span style="color: #990000">();</span>
                <span style="color: #FF0000">}</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
                    P<span style="color: #990000">.</span>Logger<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">Info</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Failed on save"</span><span style="color: #990000">);</span>
                <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
                form<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">close</span></span><span style="color: #990000">();</span>
            <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
                <span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(</span>message<span style="color: #990000">);</span>
            <span style="color: #FF0000">}</span>
        <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
            form<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">close</span></span><span style="color: #990000">();</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>In the handler code snippet above validation function is invoked and if
successful then changes are saved to the database. Write the <span class="monospaced">validate</span>
function stub we&#8217;ll return to its code later.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Validates the view.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> Validation error message or false value if form is valid</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">validate</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> message <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">validateOwner</span></span><span style="color: #990000">();</span>
    message <span style="color: #990000">+=</span> <span style="font-weight: bold"><span style="color: #000000">validatePets</span></span><span style="color: #990000">();</span>
    message <span style="color: #990000">+=</span> <span style="font-weight: bold"><span style="color: #000000">validateVisits</span></span><span style="color: #990000">();</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> message<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Double click on the Cancel button and insert JavaScript code to perform
the form close action:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Cancel button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> event Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>cancelButton<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    form<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">close</span></span><span style="color: #990000">();</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>The event handler above will be invoked on form initialization.</p></div>
<div class="paragraph"><p>Now it is time to add the code for the pets and their visits management.</p></div>
<div class="paragraph"><p>Insert pets Add button <span class="monospaced">onActionPerformed</span> event handler to add a new
pet:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * The add pet button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> evt Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnAddPet<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    model<span style="color: #990000">.</span>petsQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{}</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Insert pets Delete button <span class="monospaced">onActionPerformed</span> event handler to delete a
pet:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Delete pet button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Deletes the selected pets.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> evt Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnDeletePet<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">confirm</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Delete selected pets?"</span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> form<span style="color: #990000">.</span>grdPets<span style="color: #990000">.</span>selected<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            model<span style="color: #990000">.</span>petsQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">splice</span></span><span style="color: #990000">(</span>model<span style="color: #990000">.</span>petsQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">indexOf</span></span><span style="color: #990000">(</span>form<span style="color: #990000">.</span>grdPets<span style="color: #990000">.</span>selected<span style="color: #990000">[</span>i<span style="color: #990000">]),</span> <span style="color: #993399">1</span><span style="color: #990000">);</span>
        <span style="color: #FF0000">}</span>
        model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">save</span></span><span style="color: #990000">();</span>
    <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Insert visits Add button <span class="monospaced">onActionPerformed</span> event handler to add a new
visit to the hotel:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Add visit button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> evt Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnAddVisit<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    model<span style="color: #990000">.</span>visitsQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{}</span><span style="color: #990000">);</span>
    model<span style="color: #990000">.</span>visitsQuery<span style="color: #990000">.</span>cursor<span style="color: #990000">.</span>FROMDATE <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Date</span></span><span style="color: #990000">();</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Insert visits Delete button <span class="monospaced">onActionPerformed</span> event handler to delete
a pet&#8217;s visit:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Delete visit button's click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> evt Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnDeleteVisit<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">confirm</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Delete selected visits?"</span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> form<span style="color: #990000">.</span>grdVisits<span style="color: #990000">.</span>selected<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            model<span style="color: #990000">.</span>visitsQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">splice</span></span><span style="color: #990000">(</span>model<span style="color: #990000">.</span>visitsQuery<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">indexOf</span></span><span style="color: #990000">(</span>form<span style="color: #990000">.</span>grdVisits<span style="color: #990000">.</span>selected<span style="color: #990000">[</span>i<span style="color: #990000">]),</span> <span style="color: #993399">1</span><span style="color: #990000">);</span>
        <span style="color: #FF0000">}</span>
        model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">save</span></span><span style="color: #990000">();</span>
    <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Next we will provide the logic for the form validation. Edit the
<span class="monospaced">validate</span> function and implement it as follows to perform the owner&#8217;s
and the pets and visits validation:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Validates the view.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> Validation error message or empty String if form is valid</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">validate</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> message <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">validateOwner</span></span><span style="color: #990000">();</span>
    message <span style="color: #990000">+=</span> <span style="font-weight: bold"><span style="color: #000000">validatePets</span></span><span style="color: #990000">();</span>
    message <span style="color: #990000">+=</span> <span style="font-weight: bold"><span style="color: #000000">validateVisits</span></span><span style="color: #990000">();</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> message<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Add owner&#8217;s fields validation code:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Validates owner's properties.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> Validation error message or empty String if form is valid</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">validateOwner</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> message <span style="color: #990000">=</span> <span style="color: #FF0000">""</span><span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>form<span style="color: #990000">.</span>edFirstName<span style="color: #990000">.</span>value<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        message <span style="color: #990000">+=</span> <span style="color: #FF0000">"First name is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>form<span style="color: #990000">.</span>edLastName<span style="color: #990000">.</span>value<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Last name is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>form<span style="color: #990000">.</span>edAddress<span style="color: #990000">.</span>value<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Address is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>form<span style="color: #990000">.</span>edCity<span style="color: #990000">.</span>value<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        message <span style="color: #990000">+=</span> <span style="color: #FF0000">"City is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>form<span style="color: #990000">.</span>edPhone<span style="color: #990000">.</span>value<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Phone number is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>form<span style="color: #990000">.</span>edEmale<span style="color: #990000">.</span>value<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        message <span style="color: #990000">+=</span> <span style="color: #FF0000">"E-Mail is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> message<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>The pets validation code is as follows:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Validates pets entity.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> Validation error message or empty String if form is valid</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">validatePets</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> message <span style="color: #990000">=</span> <span style="color: #FF0000">""</span><span style="color: #990000">;</span>
    pets<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">forEach</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>pet<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>pet<span style="color: #990000">.</span>name<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Pet's name is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>pet<span style="color: #990000">.</span>birthdate<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Pet's birthdate is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>pet<span style="color: #990000">.</span>type<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Pet's type is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> message<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Insert the visits validation code for the currently selected pet:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Validates visits entity.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> Validation error message or empty String if form is valid</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">validateVisits</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> message <span style="color: #990000">=</span> <span style="color: #FF0000">""</span><span style="color: #990000">;</span>
    form<span style="color: #990000">.</span>grdVisits<span style="color: #990000">.</span>data<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">forEach</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>visit<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>visit<span style="color: #990000">.</span>fromdate<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Visit from date is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>visit<span style="color: #990000">.</span>todate<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Visit to date is required.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>visit<span style="color: #990000">.</span>fromdate <span style="color: #990000">&gt;=</span> visit<span style="color: #990000">.</span>todate<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
            message <span style="color: #990000">+=</span> <span style="color: #FF0000">"Visit 'from' date must be before 'to' date.</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> message<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>At this stage you need to run and test your application. To do that, run
the application with desktop client and direct connection to the
database. Use step-by-step code debugging to make sure your JavaScript
works correctly.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="owners-report">Owners report</h2>
<div class="sectionbody">
<div class="paragraph"><p>In this section we are going to create a simple report about the owners.</p></div>
<div class="paragraph"><p>Create a new Report application element with the <span class="monospaced">OwnersReport</span> name.
Add <span class="monospaced">OwnersQuery</span> to data model.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>self<span style="color: #990000">.</span>execute <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>onSuccess<span style="color: #990000">,</span> onFailure<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    model<span style="color: #990000">.</span>ownersQuery<span style="color: #990000">.</span>params<span style="color: #990000">.</span>lastNamePattern <span style="color: #990000">=</span> <span style="color: #FF0000">"%%"</span><span style="color: #990000">;</span>
    model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> report <span style="color: #990000">=</span> template<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">generateReport</span></span><span style="color: #990000">();</span>
        report<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">show</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">//| report.print(); | var savedTo = report.save(saveTo ?);</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//            onSuccess(report);</span></span>
    <span style="color: #FF0000">}</span><span style="color: #990000">,</span> onFailure<span style="color: #990000">);</span>

<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>On layout tab click on <em>edit report template</em> to edit the report template. Provide the report&#8217;s header,
owners tables columns headers and the columns tags as it shown below:</p></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:20%;">
<col style="width:20%;">
<col style="width:20%;">
<col style="width:20%;">
<col style="width:20%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" ><span class="monospaced">Full Name</span> </th>
<th class="tableblock halign-left valign-top" ><span class="monospaced">Address</span> </th>
<th class="tableblock halign-left valign-top" ><span class="monospaced">City</span> </th>
<th class="tableblock halign-left valign-top" ><span class="monospaced">Phone</span> </th>
<th class="tableblock halign-left valign-top" ><span class="monospaced">E-mail</span></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">${model.ownersQuery.fullName}</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">${model.ownersQuery.address}</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">${model.ownersQuery.city}</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">${model.ownersQuery.phone}</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">${model.ownersQuery.email}</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>Go to the <span class="monospaced">OwnersView</span> form and add the Report button. Change the button
name, the caption text and provide its press event handler code:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Report button click event handler.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> evt Event object</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
form<span style="color: #990000">.</span>btnReport<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> oReport <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OwnersReport</span></span><span style="color: #990000">();</span>
      oReport<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">execute</span></span><span style="color: #990000">();</span>
  <span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Here we can create a new report instance, set its parameter to the similar
parameter of the`OwnersView` form and display the report.</p></div>
<div class="paragraph"><p>But this will work only in SE client. To make this work on HTML5 application, we should create new server module, and place code as shown below:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> *</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@constructor</span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@public</span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">serverModule</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> self <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span> model <span style="color: #990000">=</span> P<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">loadModel</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>constructor<span style="color: #990000">.</span>name<span style="color: #990000">);</span>

    self<span style="color: #990000">.</span>execute <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>reportSuccessCallback<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> oReport <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OwnersReport</span></span><span style="color: #990000">();</span>
        oReport<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">execute</span></span><span style="color: #990000">(</span>reportSuccessCallback<span style="color: #990000">);</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Because we are going to call our server module over network, we should add annotation @public (like in queries).</p></div>
<div class="paragraph"><p>On the next step we need to modify report generation code, where we will return generated report to callback.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>self<span style="color: #990000">.</span>execute <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>onSuccess<span style="color: #990000">,</span> onFailure<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    model<span style="color: #990000">.</span>ownersQuery<span style="color: #990000">.</span>params<span style="color: #990000">.</span>lastNamePattern <span style="color: #990000">=</span> <span style="color: #FF0000">"%%"</span><span style="color: #990000">;</span>
    model<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">requery</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> report <span style="color: #990000">=</span> template<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">generateReport</span></span><span style="color: #990000">();</span>
        <span style="font-style: italic"><span style="color: #9A1900">//report.show(); | report.print(); | var savedTo = report.save(saveTo ?);</span></span>
        <span style="font-weight: bold"><span style="color: #000000">onSuccess</span></span><span style="color: #990000">(</span>report<span style="color: #990000">);</span>
    <span style="color: #FF0000">}</span><span style="color: #990000">,</span> onFailure<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>We also should rewrite code in Report button:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> reportCallback <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>report<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    report<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">show</span></span><span style="color: #990000">();</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

form<span style="color: #990000">.</span>btnReport<span style="color: #990000">.</span>onActionPerformed <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="color: #990000">(</span>event<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> srvModule <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> P<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">ServerModule</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"serverModule"</span><span style="color: #990000">);</span>
    srvModule<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">execute</span></span><span style="color: #990000">(</span>reportCallback<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>After report has been generated, it will be returned to client. If you are launching your&#8217;s application as HTML5 client, then report will be downloaded by browser when it&#8217;s method <em>show</em> is called, otherwise it will launch assosiated application (Excel for example).</p></div>
<div class="paragraph"><p>Thanks for you attention.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="revision-history">Revision History</h2>
<div class="sectionbody">
<div class="paragraph"><p>0-0 8.08.2013 Vadim Vashkevich <a href="mailto:vv@altsoft.biz">vv@altsoft.biz</a> Maxim Lipnin <a href="mailto:ml@altsoft.biz">ml@altsoft.biz</a> Initial revision</p></div>
<div class="paragraph"><p>0-0 29.04.2015 Eugeny Konstantinov <a href="mailto:jskonst@altsoft.biz">jskonst@altsoft.biz</a> Marat Gainullin <a href="mailto:mg@altsoft.biz">mg@altsoft.biz</a> Update doc to platypus version 5.0</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Last updated 2015-04-29 10:16:54 MSK
</div>
</div>
</body>
</html>
